from difflib import SequenceMatcher
import binascii

dic = {
  '.JPG': 'ffd8ffe000104a464946000101010048004800',
  '.gz': '1f8b0800d2d6f74c0003ecfd7b431bd9952f0c',
  '.torrent': '64383a616e6e6f756e636534343a687474703a',
  '.zip': '504b03042d00020008006c8f2a4a63151854ff',
  '.img': '00000000000000000000000000000000000000',
  '.exe': '4d5a90000300000004000000ffff0000b80000',
  '.pdf': '255044462d312e370d0a25b5b5b5b50d0a3120',
  '.rar': '526172211a0700cf907300000d000000000000',
  '.xlsx': '504b030414000600080000002100413782cf6e',
  '.bar': '504b0304140008080800c69164470000000000',
  '.png': '89504e470d0a1a0a0000000d49484452000003',
  '.apk': '504b0304140008000800b189153958b95addf1',
  '.msi': 'd0cf11e0a1b11ae10000000000000000000000',
  '.mp4': '000000206674797069736f6d0000020069736f',
  '.doc': 'd0cf11e0a1b11ae10000000000000000000000',
  '.pptx': '504b03041400060008000000210015b171f293',
  '.jpg': 'ffd8ffe000104a464946000101010060006000',
  '.eml': '52656365697665643a206279203139382e3134',
  '.docx': '504b0304140008080800728c864b0000000000',
  '.iso': '33ed9090909090909090909090909090909090',
  '.ods': '504b030414000008000073664e4c856c398a2e',
  '.py': '232054696d2076616e20426c6572636b205331',
  '.mp3': '49443304000000021745544454470000001400',
  '.tar': '73616d62612d342e302e382f2e74657374722e',
  '.sql': '2d2d204d7953514c2064756d702031302e3133',
  '.php': '3c3f7068700a0a66756e6374696f6e20737069',
  '.js': '2f2f206a5175657279205357464f626a656374',
  '.txt': '3d3d3d20576f7264507265737320566964656f',
  '.swf': '4357530fddab0300789ca479039465cbb6e549',
  '.css': '236d61696e5f66656174757265645f706c7567',
  '.html': '3c68746d6c3e3c626f6479206267636f6c6f72',
  '.gif': '47494638396107000b00a10200000000ffffff',
  '.mo': 'de12049500000000120000001c000000ac0000',
  '.po': '6d736769642022220a6d73677374722022220a',
  '.DS_Store': '00051607000200000000000000000000000000',
  '.rtf': '00051607000200000000000000000000000000',
  '.ttf': '00010000000d0080000300504646544d4d081e',
  '.hash': '66696c653a09737567617263726d63652e7371',
  '.log': '32323a32323a34352e333932205b373830345d',
  '.ini': 'fffe5b003000780030003400300033005d000d',
  '.cab': '49536328340800040000000000020000000000',
  '.hdr': '49536328340800040000000000020000307300',
  '.dll': '4d5a90000300000004000000ffff0000b80000',
  '.bin': '6307005300400000a804000000010000060000',
  '.inx': '74c42c84e1e5d42810fb00203c24fb4d11201d',
  '.isn': '0e0fd28ccc1f573c0d8e830dd88f25ac2a4b86',
  '.iss': '5b496e7374616c6c536869656c642053696c65',
  '.xml': '3c3f786d6c2076657273696f6e3d22312e3022',
  '.sdf': '27088a0300000000490000000000000000093d',
  '.inf': '3b0d0a3b20494e462066696c6520666f722069',
  '.cat': '30830a76df06092a864886f70d010702a0830a',
  '.sys': '4d5a90000300000004000000ffff0000b80000',
  '.dat': '4d5a90000300000004000000ffff0000b80000',
  '.DAT': '4d445452707219026b030000e0020000831443',
  '.cpl': '4d5a90000300000004000000ffff0000b80000',
  '.INF': '3b0d0a3b20494e462066696c6520666f722069',
  '.CAT': '30830b3a2606092a864886f70d010702a0830b',
  '.cfg': '3c3f786d6c2076657273696f6e3d22312e3022',
  '.config': '3c3f786d6c2076657273696f6e3d22312e3022',
  '.Coding': '436f64696e6720636f6e76656e74696f6e7320',
  '.8': '275c2220740a2e5c2220202020205469746c65',
  '.1': '275c2220740a2e5c2220202020205469746c65',
  '.3': '275c2220740a2e5c2220202020205469746c65',
  '.7': '275c2220740a2e5c2220202020205469746c65',
  '.5': '275c2220740a2e5c2220202020205469746c65',
  '.adm': '434c415353204d414348494e450d0a0d0a4341',
  '.reg': '52454745444954340d0a0d0a3b436f6e747269',
  '.m4': '646e6c2028432920323030332d32303034204a',
  '.ac': '41435f494e49542878736c742f6c617465782e',
  '.desktop': '5b4465736b746f7020456e7472795d0a4e616d',
  '.svg': '3c3f786d6c2076657273696f6e3d22312e3022',
  '.entities': '3c212d2d0a0976696d3a66743d647464200a2d',
  '.odt': '504b0304140000000000a0ae47365ec6320c27',
  '.pl': '23212f7573722f62696e2f7065726c0a0a6d79',
  '.xsl': '3c3f786d6c2076657273696f6e3d27312e3027',
  '.sh': '23212f62696e2f73680a4449523d2e0a696620',
  '.sty': '25204c6154655820636c617373207769746820',
  '.cls': '2520244964240a252070687374796c652e636c',
  '.default': '23205468697320697320746865206d61696e20',
  '.smb': '23206175746f6d6f756e7420706f696e747320',
  '.schema': '23230a232320536368656d612066696c652066',
  '.ldif': '232320736368656d612066696c6520666f7220',
  '.IBMSecureWay': '23230a2323205375626d697474656420627920',
  '.IBM-DS': '23232053616d626120332e3020736368656d61',
  '.perl': '23212f7573722f6c6f63616c2f62696e2f7065',
  '.cpp': '2f2a5c0a202a202070636170326e62656e6368',
  '.hpp': '2f2a5c0a202a202070636170326e62656e6368',
  '.init': '23212f62696e2f73680a230a2320436f707972',
  '.prtpub': '7072747075622e6320636f6e7461696e732061',
  '.sysv': '23212f62696e2f73680a230a23204028232920',
  '.smbfs': '23212f62696e2f626173680a23204465626961',
  '.fjall': '3b6c6f67206c6576656c203d20340a3b726561',
  '.lapland': '236c6f67206c6576656c203d20340a23726561',
  '.vittjokk': '3b70726f746f636f6c203d204c414e4d414e32',
  '.WinNT': '236c6f67206c6576656c203d20340a23726561',
  '.out': '3235353a206f6b0d0a3235343a206f6b0d0a32',
  '.com': '8cca2e89169603b430cd218b2e028b1e2c8eda',
  '.guess': '2321202f62696e2f73680a2320417474656d70',
  '.sub': '2321202f62696e2f73680a2320436f6e666967',
  '.mk': '5b53554253595354454d3a3a4c49424153594e',
  '.exports': '2320546869732066696c65206973206175746f',
  '.signatures': '63686172202a74616c6c6f635f61737072696e',
  '.awk': '230a23206d6b73796d732e61776b0a230a2320',
  '.magic': '23204d616769632066696c6528312920696e66',
  '.dox': '2f2a2a0a0a5c6d61696e70616765207574696c',
  '.pup': '2320416d69676120706f77657255502028544d',
  '.sas': '2320534d616b6566696c6520666f72207a6c69',
  '.clp': '2f2a2a2a2a2a2a2a2a2a2a2a2a2a2a2a2a2a2a',
  '.inc': '2020202020202a20205a4c49422e494e43202d',
  '.contrib': '416c6c2066696c657320756e64657220746869',
  '.adb': '2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d',
  '.ads': '2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d2d',
  '.gpr': '70726f6a656374205a6c69622069730a0a2020',
  '.S': '2f2a206d617463682e73202d2d2050656e7469',
  '.586': '54686973206973206120706174636865642076',
  '.686': '54686973206973206120706174636865642076',
  '.pk': '00048224258f807f',
  '.pas': '7b2a2a2a2a2a2a2a2a2a2a2a2a2a2a2a2a2a2a',
  '.mak': '23204d616b6566696c6520666f72207a6c6962',
  '.build': 'efbbbf3c3f786d6c2076657273696f6e3d2231',
  '.chm': '495453460300000060000000010000004cda5a',
  '.sln': '4d6963726f736f66742056697375616c205374',
  '.csproj': '3c56697375616c53747564696f50726f6a6563',
  '.cc': '2f2a0a202a20546573742070726f6772616d20',
  '.asm': '0d0a3b206d617463682e61736d202d2d205065',
  '.bat': '6d6c36342e657865202f466c696e6666617378',
  '.obj': '6486040066d3d742040d00001f000000000000',
  '.raw': 'edc18100000000c3a0f9535fe1005501000000',
  '.msc': '43433d636c0a43464c4147533d2d4d440a0a75',
  '.vcproj': '3c3f786d6c2076657273696f6e3d22312e3022',
  '.rc': '23696e636c756465203c77696e646f77732e68',
  '.examples': '54686973206469726563746f727920636f6e74',
  '.bor': '23204d616b6566696c6520666f72207a6c6962',
  '.dj2': '23204d616b6566696c6520666f72207a6c6962',
  '.emx': '23204d616b6566696c6520666f72207a6c6962',
  '.tc': '23204d616b6566696c6520666f72207a6c6962',
  '.mms': '2320646573637269702e6d6d733a204d4d5320',
  '.riscos': '232050726f6a6563743a2020207a6c69625f31',
  '.os2': '23204d616b6566696c6520666f72207a6c6962',
  '.projects': '54686973206469726563746f727920636f6e74',
  '.dsp': '23204d6963726f736f667420446576656c6f70',
  '.dsw': '4d6963726f736f667420446576656c6f706572',
  '.qpg': '3c5150473a47656e65726174696f6e3e0a2020',
  '.gcc': '23204d616b6566696c6520666f72207a6c6962',
  '.idl': '2f2a0a2020617473766320696e746572666163',
  '.cnf': '4e4f454d49540a',
  '.spec': '230a2320222449643a206c73622d73616d6261',
  '.xinetd': '232064656661756c743a206f66660a23206465',
  '.mandrake': '506c65617365206e6f74652074686174207468',
  '.tmpl': '23212f62696e2f73680a2320436f7079726967',
  '.pamd': '61757468092072657175697265640970616d5f',
  '.sysconfig': '23204f7074696f6e7320746f20736d62640a53',
  '.rpm': '23212f62696e2f73680a0a636173652060756e',
  '.msg': '2321202f62696e2f73680a0a6563686f0a6563',
  '.swat': '7768696c652072656164207372632064657374',
  '.master': '737761740973747265616d09746370096e6f77',
  '.Debian': '506c656173652073656520687474703a2f2f77',
  '.patch': '64696666202d4e6175722073616d62612d342e',
  '.yp': '2320657870722e79700a2320436f7079726967',
  '.PL': '757365204578745574696c733a3a4d616b654d',
  '.yml': '6e616d653a2050617273652d5069646c0a6162',
  '.pm': '23232323232323232323232323232323232323',
  '.developer': '23212f62696e2f73680a606469726e616d6520',
  '.syms': '7b0a0923206e6f20676c6f62616c206578706f',
  '.sed': '2320706f326d73672e736564202d20436f6e76',
  '.ps': '252150532d41646f62652d322e300a25254372',
  '.ico': '00000100010010100000010008006805000016',
  '.vlp': '5669727475616c206c696e65207072696e7465',
  '.stf': '54686973206469726563746f727920636f6e74',
  '.opt': '23212f62696e2f73680a2e2f636f6e66696775',
  '.et': '230a23204572726f72206d6573736167657320',
  '.asn1': '2d2d2024496424202d2d0a0a43414e5448414e',
  '.gen': '2320244964240a232053616d706c6520666f72',
  '.hin': '2f2a0a202a20436f7079726967687420286329',
  '.diff': '4f6e6c7920696e206e74702d73616d62613a20',
  '.dc': '5b676c6f62616c735d0a096e657462696f7320',
  '.member': '5b676c6f62616c735d0a096e657462696f7320',
  '.standalone': '5b676c6f62616c735d0a096e657462696f7320',
  '.zone': '3b202d2a2d207a6f6e65202d2a2d0a3b206765',
  '.0': '235374616e64617264204f70656e4c44415020',
  '.esp': '3c2520706167655f6865616465722822636f6c',
  '.ejs': '0a2f2a0a09736f6d65207465737420656a7320',
  '.tdb': '5444422066696c650a00000000000000000000',
  '.acf': '5b0a2020202020202020696d706c696369745f',
  '.vbs': '466f72204561636820486f737420496e205753',
  '.test': '2e206261736963736d622e666e730a0a746573',
  '.fns': '2321202f62696e2f73680a0a2320436f6d6d6f',
  '.domain': '73656375726974793d646f6d61696e0a706173',
  '.hostsdeny': '09686f7374732064656e79203d203132372e',
  '.hostsequiv': '20202020202020686f73746e616d65206c6f6f',
  '.invalidusers': '202020202020696e76616c6964207573657273',
  '.preexec': '70726565786563203d202f62696e2f73682050',
  '.preexec_close': '7072656578656320636c6f7365203d20796573',
  '.preexec_cl_fl': '7072656578656320636c6f7365203d20796573',
  '.server': '73656375726974793d7365727665720a706173',
  '.share': '097365637572697479203d2073686172650a',
  '.user': '097365637572697479203d20757365720a',
  '.validusers': '20202020202076616c6964207573657273203d',
  '.longarg': '230a23204d616b6566696c6520666f72206e75',
  '.psec': '230a23204d616b6566696c6520666f72207073',
  '.sec_ctx': '230a23204d616b6566696c6520666f72207365',
  '.se_access_check': '230a23204d616b6566696c6520666f72207365',
  '.grep': '5e5f6e73735f0a5e5f6773730a5e5f6b726235',
  '.cifs-utils': '4173206f662053756e646179204d6172636820',
  '.contributing': '486f7720746f20636f6e747269627574652061',
  '.packaging4': '44656269616e0a3d3d3d3d3d3d0a0a5061636b',
  '.waf': '23212f62696e2f73680a0a5052455650415448',
  '.README': '546865204c44415020736368656d612066696c',
  '.good': '402033303020494e20534f41206e733120686f',
  '.sigs': '6c64625f6164643a20696e7420287374727563',
  '.lyx': '234c795820322e302063726561746564207468',
  '.am': '45585452415f44495354203d20205c0a092e62',
  '.subunit': '546869732069732061205b736c696768746c79',
  '.corrupt': '5444422066696c650a00000000000000000000',
  '.rst': '3d3d3d3d3d3d3d3d3d3d3d3d3d3d3d3d3d3d3d',
  '.service': '5b556e69745d0a4465736372697074696f6e3d',
  '.cmd': '636f6e6e6563740a6d6b64697220780a6f7065',
  '.map': '4845494d44414c5f424153455f312e30207b0a',
  '.ilg': '54686973206973206d616b65696e6465782c20',
  '.ind': '5c626567696e7b746865696e6465787d0a0a20',
  '.sxd': '504b03041400000000008681f42ee533d0b81c',
  '.tif': '49492a003e330100789ceddd878f55c5df07e0',
  '.template': '646e3a20434e3d524944204d616e6167657224',
  '.dlz': '23205468697320444e5320636f6e6669677572',
  '.update': '2f2a0a09746869732066696c652077696c6c20',
  '.dat2': '56455253494f4e203120300a2246494c455345',
  '.simple': '494e434c554445533d2d490a43464c4147533d',
  '.tcp': '494e434c554445533d2d490a43464c4147533d',
  '.win32': '0a54686973206469726563746f727920686f6c'
}

def similar(stringa, stringb):
    return SequenceMatcher(None, stringa, stringb).ratio()

file = input("Give file input: ")
with open(file, 'rb') as f:
    content = f.read(1024) #Reads only first 1024 bytes
hex_string = str(binascii.hexlify(content))
print(hex_string[2:40])
similarity = 0
old_similarity = 0

for key, value in dic.items():
    similarity = similar(hex_string[2:40], value)
    if similarity > old_similarity:
        old_similarity = similarity
        extension = key

print(old_similarity)
print("File format recognized as: " + extension)
